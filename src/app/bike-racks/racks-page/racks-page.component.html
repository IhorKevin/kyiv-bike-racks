<google-map
    class="map-container"
    [zoom]="zoom"
    [options]="mapOptions"
    [width]="'inherit'"
    [height]="'inherit'"
    (mapClick)="clearRack($event)"
>
    <map-marker
        *ngFor="let rack of racks | async"
        [position]="{lat: rack.coords.latitude, lng: rack.coords.longitude}"
        [options]="rackMarkerOptions"
        (mapClick)="onRackSelect(rack)"
    ></map-marker>
    <map-marker *ngIf="userPosition" [position]="{lat: userPosition.coords.latitude, lng: userPosition.coords.longitude}" [options]="userMarkerOptions"></map-marker>
</google-map>

<button class="menu-button" mat-raised-button [matMenuTriggerFor]="menu">
    <mat-icon>menu</mat-icon>
</button>
<mat-menu #menu="matMenu">
    <button mat-menu-item>Альфа версія</button>
    <a mat-menu-item *ngIf="isLoggedIn | async" routerLink="/editor/create">Додати велопарковку</a>
    <button mat-menu-item *ngIf="isLoggedIn | async" type="button" (click)="logout()">Вийти</button>
</mat-menu>

<button class="mat-elevation-z2 location-button" mat-fab color="" type="button" (click)="centerMapToUserPosition()">
    <mat-icon>my_location</mat-icon>
</button>

<mat-card class="rack-details" *ngIf="selectedRack | async as r">
    <img *ngIf="r.photo" mat-card-image class="rack-details__img" [src]="r.photo" alt="Фото велопарковки">
    <mat-card-content class="rack-details__body">
        <mat-card-title>
            {{r.title || r.street_address || r.owner_name}}
            <a *ngIf="isLoggedIn | async" mat-button routerLink="/editor/edit/{{r.id}}">
                <mat-icon>edit</mat-icon>
            </a>
        </mat-card-title>
        <mat-card-subtitle>{{r.created_at?.toDate() | date:'medium'}}</mat-card-subtitle>
        <a mat-fab color="primary" class="mat-elevation-z1 rack-details__route-button" [href]="r.coords | googleMaps" target="_blank">
            <mat-icon>directions</mat-icon>
        </a>
        <mat-icon *ngIf="r.is_private" title="Приватна">policy</mat-icon>
    </mat-card-content>
</mat-card>

